# 文件、优化相关

## 目录

[CSS 优化、提高性能的方法有哪些](#jump1)

[简单介绍使用图片 base64 编码的优点和缺点](#jump2)

[各种图片格式](#jump3)

[浏览器如何判断是否支持 webp 格式图片](#jump4)

[](#jump)

[](#jump)

[](#jump)

---

<span id="jump1"></span>

## CSS 优化、提高性能的方法有哪些

### 加载性能

- 多个 css 合并，尽量减少 HTTP 请求

- css 精灵图

- 抽象提取公共样式，减少代码量

- 减少使用@import,而建议使用link，因为后者在页面加载时一起加载，前者是等待页面加载完成之后再进行加载

- 压缩 CSS 代码

- 将css文件放在页面最上面

### 选择器性能

- 避免使用通配规则，如*{}计算次数惊人！只对需要用到的元素进行选择

- 尽量少的去对标签进行选择，而是用class

- 尽量少的去使用后代选择器，降低选择器的权重值。后代选择器的开销是最高的，尽量将选择器的深度降到最低，最高不要超过三层，更多的使用类来关联每一个标签元素。

- 了解哪些属性是可以通过继承而来的，然后避免对这些属性重复指定规则

### 渲染性能

- 慎重使用高性能属性：浮动、定位。

- 尽量减少页面重排、重绘。

- 去除空规则：｛｝。空规则的产生原因一般来说是为了预留样式。去除这些空规则无疑能减少css文档体积。

- 属性值为0时，不加单位。

- 标准化各种浏览器前缀：带浏览器前缀的在前。标准属性在后。

- 正确使用display的属性，由于display的作用，某些样式组合会无效，徒增样式体积的同时也影响解析性能。

- 不滥用web字体。web fonts通常体积庞大，而且一些浏览器在下载web fonts时会阻塞页面渲染损伤性能

- css单一样式：当需要下边距和左边距的时候，很多时候选择:margin:top 0 bottom 0;但margin-bottom:bottom;margin-left:left;执行的效率更高

- 选择器优化嵌套，尽量避免层级过深 （用‘>’替换‘ ’）

- 避免使用CSS表达式

- 属性值为小于1的小数时，省略小数点前面的0

### 可维护性、健壮性

- 将具有相同属性的样式抽离出来，整合并通过class在页面中进行使用，提高css的可维护性

- 样式与内容分离：将css代码定义到外部css中

---

<span id="jump2"></span>

## 简单介绍使用图片 base64 编码的优点和缺点

base64编码是一种图片处理格式，通过特定的算法将图片编码成一长串字符串，在页面上显示的时候，可以用该字符串来代替图片的url属性

### 使用base64的优点

减少一个图片的HTTP请求

### 使用base64的缺点

- 根据base64的编码原理，编码后的大小会比原文件大小大1/3，如果把大图片编码到html/css中，不仅会造成文件体积的增加，影响文件的加载速度，还会增加浏览器对html或css文件解析渲染的时间

- 使用base64无法直接缓存，要缓存只能缓存包含base64的文件，比如HTML或者CSS，这相比域直接缓存图片的效果要差很多

- 兼容性的问题，ie8以前的浏览器不支持

---

<span id="jump3"></span>

## 各种图片格式

### BMP格式

它是无损压缩的，支持索引色和直接色的点阵图

由于它基本上没有进行压缩，因此它的文件体积一般比较大

### GIF格式

它是无损压缩的使用索引色的点阵图

由于使用了LZW压缩方法，因此文件的体积很小

并且GIF还支持动画和透明度

但因为它使用的是索引色，所以它适用于一些对颜色要求不高且需要文件体积小的场景

### JPEG格式

它是有损压缩的使用直接色的点阵图

由于使用了直接色，色彩较为丰富，一般适用于来存储照片

但由于使用的是直接色，可能文件的体积相对于GIF格式来说更大

### PNG-8格式

它是无损压缩的使用索引色的点阵图

它是GIF的一种很好的替代格式，它也支持透明度的调整，并且文件的体积相对于GIF格式更小

一般来说如果不是需要动画的情况，我们都可以使用PNG-8格式代替GIF格式

### PNG-24格式

它是无损压缩的使用直接色的点阵图

PNG-24的优点是它使用了压缩算法，所以它的体积比BMP格式的文件要小得多，但是相对于其他的几种格式，还是要大一些。

### svg格式

它是矢量图，它记录的图片的绘制方式，因此对矢量图进行放大和缩小不会产生锯齿和失真

它一般适合于用来制作一些网站logo或者图标之类的图片

### webp格式

它是支持有损和无损两种压缩方式的使用直接色的点阵图

使用webp格式的最大的优点是，在相同质量的文件下，它拥有更小的文件体积。因此它非常适合于网络图片的传输

这是谷歌开发的一种新的图片格式，目前在兼容性上还不是太好

---

<span id="jump4"></span>

## 浏览器如何判断是否支持 webp 格式图片

- 宽高判断法。通过创建image对象，将其src属性设置为webp格式的图片，然后在onload事件中获取图片的宽高，如果能够获取，则说明浏览器支持webp格式图片。如果不能获取或者触发了onerror函数，那么就说明浏览器不支持webp格式的图片。

- canvas判断方法。我们可以动态的创建一个canvas对象，将canvas的toDataURL设置为webp格式，然后判断返回值中是否含有image/webp字段，如果包含则说明支持WebP，反之则不支持

